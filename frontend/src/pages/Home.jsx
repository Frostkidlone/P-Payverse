import React, {useState, useEffect} from 'react'; import { PiMock } from '../mockPiSDK'; export default function Home(){ const [products,setProducts]=useState([]); const [user,setUser]=useState(null); const [redeem,setRedeem]=useState(''); const [msg,setMsg]=useState(''); useEffect(()=>{ fetch('/api/products').then(r=>r.json()).then(setProducts).catch(()=>setProducts([])) },[]); async function login(){ const u=await PiMock.authenticate(); setUser(u); setMsg('Logged in (mock)'); setTimeout(()=>setMsg(''),1400) } async function redeemCode(){ if(!redeem) return setMsg('Enter code'); const res=await fetch('/api/redeem',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({code:redeem,userId:user?user.id:1})}); const j=await res.json(); setMsg(j.message); setRedeem(''); setTimeout(()=>setMsg(''),1800) } async function buy(p){ const pay=await PiMock.pay({amount:p.price}); await fetch('/api/purchase',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId:user?user.id:1,productId:p.id,txId:pay.txId})}); setMsg('Paid (mock): '+pay.txId); setTimeout(()=>setMsg(''),2000) } return (<div className='container'><header style={{display:'flex',alignItems:'center',gap:12}}><div className='logo'>P‑PayVerse</div><div className='small' style={{marginLeft:8}}>Pi Hackathon Prototype</div></header><div className='card' style={{marginTop:12}}><div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}><div><h2 style={{margin:0}}>Gift Cards & Marketplace</h2><div className='small'>Redeem gift cards, buy items, earn cashback</div></div><div>{!user? <button className='btn' onClick={login}>Continue with Pi (Mock)</button>: <div className='small'>Hi, {user.name}</div>}</div></div><div style={{display:'flex',gap:10,marginTop:12}}><input value={redeem} onChange={e=>setRedeem(e.target.value)} placeholder='Enter gift card code' style={{flex:1,padding:10,borderRadius:8,border:'none',background:'#061226',color:'white'}}/><button className='btn' onClick={redeemCode}>Redeem</button></div><div className='grid' style={{marginTop:12}}>{products.map(p=>(<div key={p.id} className='card'><div className='product-img'>Image</div><h3 style={{marginTop:8}}>{p.name}</h3><div className='small'>{p.vendor}</div><div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginTop:8}}><div><strong>{p.price} Pi</strong><div className='small'>Cashback: {p.cashback}%</div></div><div style={{display:'flex',flexDirection:'column',gap:8}}><button className='btn' onClick={()=>buy(p)}>Pay with Pi</button><button className='btn' style={{background:'transparent',border:'1px solid rgba(255,255,255,0.06)'}}>Add to Cart</button></div></div></div>))}</div></div><div style={{display:'flex',gap:12,marginTop:12}}><div className='card' style={{flex:1}}><h4>Leaderboard</h4><div className='small'>Top Pioneers (mock)</div><ul><li>demo_1 — 120 Pi cashback</li><li>demo_2 — 85 Pi</li></ul></div><div className='card' style={{width:260}}><h4>Quick Stats</h4><div className='small'>Users: 128 (mock)</div><div className='small'>Total Pi volume: 5,400 Pi</div></div></div><div className='small' style={{marginTop:12}}>Developed by Ghost Tech — ghosttechlabs@gmail.com</div></div>) }